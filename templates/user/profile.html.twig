{% extends 'base.html.twig' %}

{% block title %}{{app.user.username}}{% endblock %}

{% block body %}

<section class="artistDetail">

    <div class="hero">

        <figure>

            {% if app.user.poster == null %}
              
                <img src="{{asset('img/avatar-gf5083c0bd_640.png')}}" alt="avatar">
            {% else %}
            
                <img src="{{asset('uploads/' ~ app.user.poster)}}" alt="profile picture"> 
            {% endif %}
            

            <figcaption>
                <h1>{{app.user.username}}</h1>

                <a class="btn btn-dark" href="{{path('edit_profile')}}">Edit profil</a>
            </figcaption>
        </figure>
    </div>


    <table>

        <thead>

            <tr>
                <th></th>
                <th>title</th>
                <th>artist</th>
                <td></td>
                <th>time</th>
                <th></th>
            </tr>
        </thead>

        <tbody>
            
            {% for song in app.user.songs %}

                <tr>
                    <td>
                        <figure>
                            <img src="{{asset('uploads/' ~ song.album.cover)}}" alt="song img">
                        </figure>
                    </td>
                    <td><a href="{{path('app_songPlayer', {'id': song.id})}}">{{song.nameSong}} </a></td>
                    <td> <a href="{{path('app_artistDetail', {'id': app.user.username})}}"> {{app.user.username}} </a></td>
                    <td>
                        {% include "like/_like.html.twig" %}
                    </td>
                    <td>3:09</td>

                    <td>
                        <div class="dropdown">
                            <button><i class="fa-solid fa-plus"></i></button>
                            
                            <div id="list-items">
                               <a href="{{path('edit_song', {'id': song.id})}}">edit</a>
                               <a href="{{path('delete_song', {'id': song.id})}}">delete</a>
                            </div>
                        </div>
                        
                    </td>
                </tr>


            {% endfor %}
        </tbody>
    </table>

    <div class="album">

        <div class="title">

            <h1>Albums</h1>

            <div class="buttons">

                <a href="{{path('add_album')}}">Add Album</a>
                <a href="{{path('app_artistAlbum', {'id': app.user.id})}}">More</a>
            </div>
        </div>
        
        <div class="cards">
            
            {% for album in albums %}

                <div class="mcard">

                    <div class="dropdown">
                        <button class="fa-solid fa-ellipsis-vertical"></button>
                  
                        <div id="list-items">
                           <a href="{{path('edit_album', {'id': album.id})}}">edit</a>
                           <a href="{{path('delete_album', {'id': album.id})}}">delete</a>
                        </div>
                    </div>
                    
                    <a href="{{path('app_albumDetail', {'id': album.uuid})}}">

                        <figure>
                            <img src="{{asset('uploads/' ~ album.cover)}}" alt="album cover">          
                        </figure>
                        
                        <h3>{{album.nameAlbum}} </h3>

                    </a>
                
                    
                </div>
            {% endfor %}
                
        </div>

        {% if app.user.bio != null %}
            
            <div class="about" id="myBtn">

                <div class="title">
                    <h2>About</h2>
                </div>

                <div class="card m-5 d-flex flex-column p-3">

                    {% if app.user.poster != null %}

                        <figure>
                            <img class="rounded-circle" src="{{asset('uploads/' ~ app.user.poster)}}" alt="{{app.user.username}} image">

                        </figure>  
                    {% endif %}
                    
                    
                    <figcaption class="d-flex flex-column p-5">

                        {% if app.user.subUser2|length <= 1 %}
                            <h3 class="text-light">{{app.user.subUser2|length}} subcriber</h3>
                        
                        {% else %}
                            <h3 class="text-light">{{app.user.subUser2|length}} subcribers</h3>

                        {% endif %}

                        {# TODO: set limit for num of char 234 #}
                        {% if app.user.bio|length > 234 %}
                            
                            <p class="text-light">{{app.user.bio}}... </p>

                        {% else %}
                            <p class="text-light">{{app.user.bio}} </p>

                        {% endif %}
                    </figcaption>

                </div>
            </div>

            {# TODO: style modal, sub count #}
            <div id="myModal" class="modal">

                <div class="modal-content w-50">
    
                    <span class="close">&times;</span>

                    {% if app.user.poster != null %}
                    
                        <figure>
                            <img class="rounded-circle" src="{{asset('uploads/' ~ app.user.poster)}}" alt="{{app.user.username}} image">

                        </figure>  
                    {% endif %}

                    {% if app.user.subUser2|length <= 1 %}
                        <h3>{{app.user.subUser2|length}} subcriber</h3>
                    
                    {% else %}
                        <h3>{{app.user.subUser2|length}} subcribers</h3>

                    {% endif %}

                    <p>{{app.user.bio}} </p>
    
                </div>
    
            </div>

        {% else %}

            <a class="btn btn-dark" href="{{path('edit_profile')}}">add a bio</a>
        {% endif %}
    </div>

</section>
{% endblock %}
